# Ref:
# - https://pixi.sh/latest/reference/pixi_manifest/
[workspace]
channels = [
	"https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge",
	"https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch",
	"https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch-lts",
	"https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch-test",
	"conda-forge",
	"pytorch",
	"pytorch-test",
]
platforms = ["linux-64", "win-64"]
name = "ubears"
version = "0.2.4"
authors = [
	"UBeaRLy <ubearly@outlook.com>",
]
description = "A project with some out-of-box utils for data analysis."
license = "Apache-2.0"
license-file = "license.txt"
readme = "README.md"
homepage = "https://github.com/xyy15926/aki7proj"
repository = "https://github.com/xyy15926/aki7proj"
documentation = "https://github.com/xyy15926/aki7proj"
channel-priority = "strict"
requires-pixi = ">=0.55"
# Enable Pixi's preview features.
preview = ["pixi-build"]

[pypi-options]
index-url = "https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple"
extra-index-urls = [
    "https://mirrors.aliyun.com/pypi/simple",
    "https://pypi.org/simple",
]
# Or true/false for all
no-build-isolation = []
no-build = []
no-binary = []

[system-requirements]
libc = "2.28"
# cuda = "12"

[dependencies]
python				= ">=3.12.11,<3.13"
numpy				= ">=2.3.3,<3"
pandas				= ">=2.3.2,<3"
scipy				= ">=1.16.0,<2"
scikit-learn		= ">=1.7.2,<2"
SQLAlchemy			= ">=2.0.43,<3"
openpyxl			= ">=3.1.5,<4"
tqdm				= ">=4.67.1,<5"
jieba				= ">=0.42.1,<0.43"
pytorch				= ">=2.7.1,<3"
tensorboard			= ">=2.20.0,<3"
pyecharts			= ">=2.0.8,<3"
pytest				= ">=8.4.2,<9"
ipython				= ">=9.5.0,<10"
networkx			= ">=3.5,<4"
xgboost				= ">=3.0.5,<4"
PyMySQL				= ">=1.1.2,<2"
TA-Lib				= ">=0.6.4,<0.7"
torchvision			= ">=0.22.0,<0.23"
ruff = ">=0.13.1,<0.14"
# streamlit			= "*"

[pypi-dependencies]
ubears				= { path = ".", editable = true }
chinese_calendar	= ">=1.10.0, <2"
numpy_financial		= ">=1.0.0, <2"
build				= ">=1.3.0, <2"
twine				= ">=6.2.0, <7"
# cx-Oracle			= "*"

[target.linux-64.dependencies]
pdfplumber			= ">=0.11.5,<0.12"

[feature.prod.dependencies]
python				= ">=3.9"
numpy				= ">=1.2, <=2.4"
pandas				= ">=1.4, <=2.4"
scipy				= ">=1.10, <=1.16"
scikit-learn		= ">=1.1, <=1.8"
SQLAlchemy			= ">=1.4"
openpyxl			= ">=3.0"
tqdm				= ">=4.0"
jieba				= "*"
pytorch				= "*"
tensorboard			= "*"
pyecharts			= ">=2.0"

[feature.prod-test.dependencies]
pytest				= "*"
torchvision			= ">=0.22.0,<0.23"
TA-Lib				= ">=0.6.4,<0.7"

[feature.prod-test.pypi-dependencies]
numpy-financial		= ">=1.0.0, <2"

[feature.prod.pypi-dependencies]
ubears				= { path = ".", editable = true }
chinese_calendar	= "*"

[feature.prod.target.linux-64.dependencies]
pdfplumber			= "*"

[environments]
default = {solve-group = "default"}

[environments.prod]
features = [ "prod", "prod-test" ]
solve-group = "default"
no-default-feature = true

# Ref
# - https://pixi.sh/latest/workspace/advanced_tasks/
# - https://github.com/prefix-dev/pixi/issues/4350
# Tasks with no-prefix is set for default feature only.
[tasks]
test = { cmd = "pytest" }
pypi-build = { cmd = "python -m build", depends-on = ["test-all"] }
pypi-check = { cmd = "python -m twine check dist/*", depends-on = ["pypi-build"] }
pypi-upload = { cmd = "python -m twine check upload/*", depends-on = ["pypi-check"] }

# Tasks has to be redefined explicitly for feature of the environment with
# `no-default-feature` set.
[feature.prod.tasks]
test = { cmd = "pytest" }

[tasks.test-all]
depends-on = [
	{ task = "test", environment = "default" },
	{ task = "test", environment = "prod" },
]

[activation]
scripts = []
env = {}

# Ref
# - https://pixi.sh/latest/build/getting_started/
# - https://pixi.sh/latest/build/dependency_types/
# - https://pixi.sh/latest/build/python/
# - https://pixi.sh/latest/build/backends/
# - https://prefix-dev.github.io/pixi-build-backends/backends/pixi-build-python/
[package]
# Inherit from the workspace manifest.
name			= { workspace = true }
version			= { workspace = true }
authors			= { workspace = true }
description		= { workspace = true }
documentation	= { workspace = true }
homepage		= { workspace = true }
license			= { workspace = true }
license-file	= { workspace = true }
readme			= { workspace = true }
repository		= { workspace = true }

[package.build]
source = { path = "." }

[package.build.backend]
name = "pixi-build-python"
version = "*"
# `channels` here will be overriden by `workspace.channels`.
channels = [
	"conda-forge",
	"pytorch",
	"pytorch-test",
]

[package.build.config]
noarch = true
env = {}
# ignore-pyproject-manifest = true

[package.build-dependencies]
# Dependecies for build environment when building.
python				= ">=3.12"
pip					= "*"
# cmake = "*"
# git = "*"

[package.host-dependencies]
# Dependecies for host when building.
python				= ">=3.9"
hatchling			= "*"

[package.run-dependencies]
python				= ">=3.9"
numpy				= ">=1.2, <=2.4"
pandas				= ">=1.4, <=2.4"
scipy				= ">=1.10, <=1.16"
scikit-learn		= ">=1.1, <=1.8"
SQLAlchemy			= ">=1.4"
openpyxl			= ">=3.0"
jieba				= "*"
pdfplumber			= "*"
pytorch				= "*"
tqdm				= ">=4.0"
pyecharts			= ">=2.0"
numpy_financial		= "*"
chinese_calendar	= "*"
